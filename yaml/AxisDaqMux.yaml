##############################################################################
## This file is part of 'SLAC Firmware Standard Library'.
## It is subject to the license terms in the LICENSE.txt file found in the 
## top-level directory of this distribution and at: 
##    https://confluence.slac.stanford.edu/display/ppareg/LICENSE.html. 
## No part of 'SLAC Firmware Standard Library', including this file, 
## may be copied, modified, propagated, or distributed except according to 
## the terms contained in the LICENSE.txt file.
##############################################################################
#schemaversion 3.0.0
#once

AxisDaqMux: &AxiDaqMux
  name: AxisDaqMux
  description: Data acquisition control
  class: MMIODev
  configPrio: 1
  size: 0x400
  children:
    #########################################################
    SoftwareTrigger:
      at:
        offset: 0x00
      class: IntField
      name: SoftwareTrigger
      sizeBits: 1
      lsBit: 0
      mode: RW
      description: Trigger data acquisition (bit0 - Auto clear register)
    #########################################################
    Mode:
      at:
        offset: 0x00
      class: IntField
      name: Mode
      sizeBits: 1
      lsBit: 1
      mode: RW
      description: "Mode of DAQ - '0'  - until packet size and needs trigger - '1' - sends the 4k frames continuously no trigger"
      enums:
        Triggered:
          class: Enum
          value: 0
        Continuous:
          class: Enum
          value: 1
    #########################################################
    HwTriggerMask:
      at:
        offset: 0x00
      class: IntField
      name: HwTriggerMask
      sizeBits: 1
      lsBit: 2
      mode: RW
      description: "Hardware Trigger Mask '1' - Enabled, '0' - Disabled"
      enums:
        Disabled:
          class: Enum
          value: 0
        Enabled:
          class: Enum
          value: 1
    #########################################################
    DecimationMode:
      at:
        offset: 0x00
      class: IntField
      name: DecimationMode
      sizeBits: 1
      lsBit: 3
      mode: RW
      description: "Decimation mode '1' - 16-bit, '0' - 32-bit"
      enums:
        32-bit:
          class: Enum
          value: 0
        16-bit:
          class: Enum
          value: 1
    #########################################################
    SampleDecimation:
      at:
        offset: 0x08
      class: IntField
      name: SampleDecimation
      sizeBits: 16
      mode: RW
      description: 'Reduces the sample rate. 16bit DecimationMode: 0 - SR, 1 - SR/2,
        2 - SR/4, 3 - SR/6 etc. 32bit DecimationMode: 0 - SR, 1 - SR, 2 - SR/2, 3
        - SR/3 etc.'
    #########################################################
    DaqBufferSize:
      at:
        offset: 0x0C
      class: IntField
      name: DaqBufferSize
      sizeBits: 32
      mode: RW
      description: Size of a single continuous data buffer (number of 32-bit words)
    #########################################################
    S0ChannelSelect:
      at:
        offset: 0x40
      class: IntField
      name: S0ChannelSelect
      sizeBits: 4
      mode: RW
      description: Select channel for AXI stream 1 (0 - Disabled, 1 - Ch1, etc)
    #########################################################
    S1ChannelSelect:
      at:
        offset: 0x44
      class: IntField
      name: S1ChannelSelect
      sizeBits: 4
      mode: RW
      description: Select channel for AXI stream 1 (0 - Disabled, 1 - Ch1, etc)
    #########################################################
    S0Pause:
      at:
        offset: 0x80
      class: IntField
      name: S0Pause
      sizeBits: 1
      lsBit: 0
      mode: RO
      description: DAQ interface busy
    ######################################################### 
    S0Ready:
      at:
        offset: 0x80
      class: IntField
      name: S0Ready
      sizeBits: 1
      lsBit: 1
      mode: RO
      description: Ready to take new data packet
    #########################################################    
    S0Overflow:
      at:
        offset: 0x80
      class: IntField
      name: S0Overflow
      sizeBits: 1
      lsBit: 2
      mode: RO
      description: Buffer overflow
    #########################################################
    S0Error:
      at:
        offset: 0x80
      class: IntField
      name: S0Error
      sizeBits: 1
      lsBit: 3
      mode: RO
      description: Error during last Acquisition - received buffer might be shorter
        then requested
    #########################################################
    S0DataInValid:
      at:
        offset: 0x80
      class: IntField
      name: S0DataInValid
      sizeBits: 1
      lsBit: 4
      mode: RO
      description: The incoming data is Valid (Usually connected to JESD valid signal).
    #########################################################
    S0Enabled:
      at:
        offset: 0x80
      class: IntField
      name: S0Enabled
      sizeBits: 1
      lsBit: 5
      mode: RO
      description: 'Streamming is: 1-enabled, 0-Disabled'
    #########################################################
    S0FrameCnt:
      at:
        offset: 0x80
      class: IntField
      name: S0FrameCnt
      sizeBits: 26
      lsBit: 6
      mode: RO
      description: Number of frames (4096 bytes) sent. In the last transfer.
    #########################################################
    S1Pause:
      at:
        offset: 0x84
      class: IntField
      name: S1Pause
      sizeBits: 1
      lsBit: 0
      mode: RO
      description: DAQ interface busy
    ######################################################### 
    S1Ready:
      at:
        offset: 0x84
      class: IntField
      name: S1Ready
      sizeBits: 1
      lsBit: 1
      mode: RO
      description: Ready to take new data packet
    #########################################################    
    S1Overflow:
      at:
        offset: 0x84
      class: IntField
      name: S1Overflow
      sizeBits: 1
      lsBit: 2
      mode: RO
      description: Buffer overflow
    #########################################################
    S1Error:
      at:
        offset: 0x84
      class: IntField
      name: S1Error
      sizeBits: 1
      lsBit: 3
      mode: RO
      description: Error during last Acquisition - received buffer might be shorter
        then requested
    #########################################################
    S1DataInValid:
      at:
        offset: 0x84
      class: IntField
      name: S1DataInValid
      sizeBits: 1
      lsBit: 4
      mode: RO
      description: The incoming data is Valid (Usually connected to JESD valid signal).
    #########################################################
    S1Enabled:
      at:
        offset: 0x84
      class: IntField
      name: S1Enabled
      sizeBits: 1
      lsBit: 5
      mode: RO
      description: 'Streamming is: 1-enabled, 0-Disabled'
    #########################################################
    S1FrameCnt:
      at:
        offset: 0x84
      class: IntField
      name: S1FrameCnt
      sizeBits: 26
      lsBit: 6
      mode: RO
      description: Number of frames (4096 bytes) sent. In the last transfer.
    #########################################################
    TriggerDaq:
      name: TriggerDaq
      class: SequenceCommand
      description: Trigger data aquisition from software.
      sequence:
      - entry: SoftwareTrigger
        value: 0x1
      - entry: SoftwareTrigger
        value: 0x0
    ######################################################### 
